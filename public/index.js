(()=>{"use strict";var t={436:(t,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Board=void 0,i.Board=class{constructor(t,i,e){this.grid=Array.from({length:e/t},(()=>Array(i/t).fill(0))),this.width=i,this.height=e}addTetromino(t){const i=t.position;for(let e=0;e<t.shape.length;e++)for(let s=0;s<t.shape[e].length;s++)0!==t.shape[e][s]&&(this.grid[i.y+e][i.x+s]=t.shape[e][s])}checkCollisionLeftRight(t){return 0===t.position.x?"LEFT":t.position.x+t.shape[0].length>=this.grid[0].length?"RIGHT":"NONE"}checkCollision(t){for(let i=0;i<t.shape.length;i++)for(let e=0;e<t.shape[i].length;e++){if(0===t.shape[i][e])continue;const s=t.position.x+e,h=t.position.y+i+1;if(h>=this.grid.length)return"BOTTOM";if(h>=0&&0!==this.grid[h][s])return"BOARD"}return"NONE"}clearFullRows(){const t=this.grid.length,i=this.grid[0].length,e=this.grid.filter((t=>!t.every((t=>t)))),s=Array.from({length:t-e.length},(()=>Array(i).fill(0)));this.grid=[...s,...e]}checkGameOver(t){return!!this.grid[0].some((t=>t))}clearBoard(){const t=this.grid.length,i=this.grid[0].length;this.grid=Array.from({length:t},(()=>Array(i).fill(0)))}}},154:(t,i,e)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Factory=void 0;const s=e(436),h=e(788),o=e(55);i.Factory=class{static createGame(){return new h.Game}static createBoard(t,i,e){return new s.Board(t,i,e)}static createTetromino(t){return new o.Tetromino(t)}}},788:function(t,i,e){var s,h,o,r,a,n,c,f,l,d,m,u,g=this&&this.__classPrivateFieldSet||function(t,i,e,s,h){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!h)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof i?t!==i||!h:!i.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?h.call(t,e):h?h.value=e:i.set(t,e),e},v=this&&this.__classPrivateFieldGet||function(t,i,e,s){if("a"===e&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof i?t!==i||!s:!i.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===e?s:"a"===e?s.call(t):s?s.value:i.get(t)};Object.defineProperty(i,"__esModule",{value:!0}),i.Game=void 0;const p=e(436),w=e(166),y=e(55);class R extends w.GameConfig{constructor(){super(30,300,600),s.add(this),h.set(this,void 0),o.set(this,void 0),r.set(this,void 0),a.set(this,void 0),n.set(this,void 0),g(this,n,0,"f"),g(this,h,document.getElementById("game"),"f"),g(this,o,v(this,h,"f").getContext("2d"),"f"),g(this,r,new p.Board(this.GRID,this.canvas_width,this.canvas_height),"f"),g(this,a,new y.Tetromino({x:3,y:0}),"f")}runGame(){window.requestAnimationFrame(v(this,s,"m",c).bind(this)),document.addEventListener("keydown",v(this,s,"m",f).bind(this))}}i.Game=R,h=new WeakMap,o=new WeakMap,r=new WeakMap,a=new WeakMap,n=new WeakMap,s=new WeakSet,c=function t(){var i;if(window.requestAnimationFrame(v(this,s,"m",t).bind(this)),!(g(this,n,(i=v(this,n,"f"),++i),"f")<16)){if(v(this,o,"f").clearRect(0,0,v(this,h,"f").width,v(this,h,"f").height),v(this,s,"m",u).call(this),v(this,s,"m",d).call(this),g(this,n,0,"f"),"BOARD"===v(this,r,"f").checkCollision(v(this,a,"f"))){if(v(this,s,"m",l).call(this),!v(this,r,"f").checkGameOver(v(this,a,"f")))return;return v(this,s,"m",l).call(this),void v(this,r,"f").clearBoard()}"BOTTOM"!==v(this,r,"f").checkCollision(v(this,a,"f"))?v(this,a,"f").moveDown():v(this,s,"m",l).call(this)}},f=function(t){switch(t.key){case"ArrowLeft":if("LEFT"===v(this,r,"f").checkCollisionLeftRight(v(this,a,"f")))break;v(this,a,"f").moveLeft();break;case"ArrowRight":if("RIGHT"===v(this,r,"f").checkCollisionLeftRight(v(this,a,"f")))break;v(this,a,"f").moveRight();break;case"ArrowDown":v(this,a,"f").moveDown();break;case" ":v(this,a,"f").rotate()}},l=function(){v(this,r,"f").addTetromino(v(this,a,"f")),v(this,r,"f").clearFullRows(),v(this,a,"f").setPosition({x:3,y:0}),v(this,a,"f").newTetromino()},d=function(){for(let t=0;t*this.GRID<this.canvas_height;t++)v(this,o,"f").beginPath(),v(this,o,"f").moveTo(0,t*this.GRID),v(this,o,"f").lineTo(this.canvas_width,t*this.GRID),v(this,o,"f").strokeStyle="lightgray",v(this,o,"f").stroke(),t*this.GRID<this.canvas_height&&(v(this,o,"f").beginPath(),v(this,o,"f").moveTo(t*this.GRID,0),v(this,o,"f").lineTo(t*this.GRID,this.canvas_height),v(this,o,"f").strokeStyle="lightgray",v(this,o,"f").stroke())},m=function(t,i){v(this,o,"f").fillStyle="blue",v(this,o,"f").fillRect(t*this.GRID,i*this.GRID,this.GRID,this.GRID),v(this,o,"f").strokeStyle="black",v(this,o,"f").strokeRect(t*this.GRID,i*this.GRID,this.GRID,this.GRID)},u=function(){var t,i;v(this,o,"f").clearRect(0,0,this.canvas_width,this.canvas_height),v(this,r,"f").grid.forEach(((t,i)=>{t.forEach(((t,e)=>{0!==t&&v(this,s,"m",m).call(this,e,i)}))})),null===(i=null===(t=v(this,a,"f"))||void 0===t?void 0:t.shape)||void 0===i||i.forEach(((t,i)=>{t.forEach(((t,e)=>{0!==t&&v(this,s,"m",m).call(this,v(this,a,"f").position.x+e,v(this,a,"f").position.y+i)}))}))}},166:(t,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.GameConfig=void 0,i.GameConfig=class{constructor(t,i,e){this.GRID=t,this.canvas_width=i,this.canvas_height=e}}},55:(t,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Tetromino=void 0,i.Tetromino=class{constructor(t){this.TETROMINO_SHAPES=[[[1,1,1,1]],[[1,1],[1,1]],[[0,1,0],[1,1,1]],[[1,0,0],[1,1,1]],[[0,0,1],[1,1,1]],[[0,1,1],[1,1,0]],[[1,1,0],[0,1,1]]],this.shape=this.createRandomTetromino(),this.position=t}get x(){return this.position.x}get y(){return this.position.y}createRandomTetromino(){const t=Math.floor(7*Math.random());return this.TETROMINO_SHAPES[t]}newTetromino(){this.shape=this.createRandomTetromino()}rotate(){this.shape=this.shape[0].map(((t,i)=>this.shape.map((t=>t[i])).reverse()))}setPosition(t){this.position=t}moveLeft(){this.position.x-=1}moveRight(){this.position.x+=1}moveDown(){this.position.y+=1}}}},i={};(function e(s){var h=i[s];if(void 0!==h)return h.exports;var o=i[s]={exports:{}};return t[s].call(o.exports,o,o.exports,e),o.exports})(154).Factory.createGame().runGame()})();