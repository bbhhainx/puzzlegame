(()=>{"use strict";var t={436:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Board=void 0,e.Board=class{constructor(t,e,i){this.grid=Array.from({length:i/t},(()=>Array(e/t).fill(0))),this.width=e,this.height=i}addTetromino(t){for(let e=0;e<t.shape.length;e++)for(let i=0;i<t.shape[e].length;i++)0!==t.shape[e][i]&&(this.grid[t.position.y+e][t.position.x+i]=t.shape[e][i])}checkCollision(t){for(let e=0;e<t.shape.length;e++)for(let i=0;i<t.shape[e].length;i++){if(0===t.shape[e][i])continue;const s=t.position.x+i,o=t.position.y+e+1;if(o>=this.grid.length)return"BOTTOM";if(o>=0&&0!==this.grid[o][s])return"BOARD"}return"NONE"}clearFullRows(){}}},154:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Factory=void 0;const s=i(436),o=i(788),h=i(55);e.Factory=class{static createGame(){return new o.Game}static createBoard(t,e,i){return new s.Board(t,e,i)}static createTetromino(t){return new h.Tetromino(t)}}},788:function(t,e,i){var s,o,h,r,a,n,c,f,l,d,m,u,v=this&&this.__classPrivateFieldSet||function(t,e,i,s,o){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!o:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?o.call(t,i):o?o.value=i:e.set(t,i),i},p=this&&this.__classPrivateFieldGet||function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)};Object.defineProperty(e,"__esModule",{value:!0}),e.Game=void 0;const w=i(436),g=i(166),y=i(55);class R extends g.GameConfig{constructor(){super(30,300,600),s.add(this),o.set(this,void 0),h.set(this,void 0),r.set(this,void 0),a.set(this,void 0),n.set(this,void 0),v(this,n,0,"f"),v(this,o,document.getElementById("game"),"f"),v(this,h,p(this,o,"f").getContext("2d"),"f"),v(this,r,new w.Board(this.GRID,this.canvas_width,this.canvas_height),"f"),v(this,a,new y.Tetromino({x:3,y:0}),"f")}runGame(){window.requestAnimationFrame(p(this,s,"m",c).bind(this)),document.addEventListener("keydown",p(this,s,"m",f).bind(this))}}e.Game=R,o=new WeakMap,h=new WeakMap,r=new WeakMap,a=new WeakMap,n=new WeakMap,s=new WeakSet,c=function t(){var e;window.requestAnimationFrame(p(this,s,"m",t).bind(this)),v(this,n,(e=p(this,n,"f"),++e),"f")<24||(p(this,h,"f").clearRect(0,0,p(this,o,"f").width,p(this,o,"f").height),p(this,s,"m",u).call(this),p(this,s,"m",d).call(this),v(this,n,0,"f"),"BOARD"!==p(this,r,"f").checkCollision(p(this,a,"f"))&&"BOTTOM"!==p(this,r,"f").checkCollision(p(this,a,"f"))?p(this,a,"f").moveDown():p(this,s,"m",l).call(this))},f=function(t){switch(t.key){case"ArrowLeft":p(this,a,"f").moveLeft();break;case"ArrowRight":p(this,a,"f").moveRight();break;case"ArrowDown":p(this,a,"f").moveDown();break;case" ":p(this,a,"f").rotate()}},l=function(){p(this,r,"f").addTetromino(p(this,a,"f")),p(this,a,"f").setPosition({x:3,y:0}),p(this,a,"f").newTetromino()},d=function(){for(let t=0;t*this.GRID<this.canvas_height;t++)p(this,h,"f").beginPath(),p(this,h,"f").moveTo(0,t*this.GRID),p(this,h,"f").lineTo(this.canvas_width,t*this.GRID),p(this,h,"f").strokeStyle="lightgray",p(this,h,"f").stroke(),t*this.GRID<this.canvas_height&&(p(this,h,"f").beginPath(),p(this,h,"f").moveTo(t*this.GRID,0),p(this,h,"f").lineTo(t*this.GRID,this.canvas_height),p(this,h,"f").strokeStyle="lightgray",p(this,h,"f").stroke())},m=function(t,e){p(this,h,"f").fillStyle="blue",p(this,h,"f").fillRect(t*this.GRID,e*this.GRID,this.GRID,this.GRID),p(this,h,"f").strokeStyle="black",p(this,h,"f").strokeRect(t*this.GRID,e*this.GRID,this.GRID,this.GRID)},u=function(){var t,e;p(this,h,"f").clearRect(0,0,this.canvas_width,this.canvas_height),p(this,r,"f").grid.forEach(((t,e)=>{t.forEach(((t,i)=>{0!==t&&p(this,s,"m",m).call(this,i,e)}))})),null===(e=null===(t=p(this,a,"f"))||void 0===t?void 0:t.shape)||void 0===e||e.forEach(((t,e)=>{t.forEach(((t,i)=>{0!==t&&p(this,s,"m",m).call(this,p(this,a,"f").position.x+i,p(this,a,"f").position.y+e)}))}))}},166:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GameConfig=void 0,e.GameConfig=class{constructor(t,e,i){this.GRID=t,this.canvas_width=e,this.canvas_height=i}}},55:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Tetromino=void 0,e.Tetromino=class{constructor(t){this.TETROMINO_SHAPES=[[[1,1,1,1]],[[1,1],[1,1]],[[0,1,0],[1,1,1]],[[1,0,0],[1,1,1]],[[0,0,1],[1,1,1]],[[0,1,1],[1,1,0]],[[1,1,0],[0,1,1]]],this.shape=this.createRandomTetromino(),this.position=t}get x(){return this.position.x}get y(){return this.position.y}createRandomTetromino(){const t=Math.floor(7*Math.random());return this.TETROMINO_SHAPES[t]}newTetromino(){this.shape=this.createRandomTetromino()}rotate(){this.shape=this.shape[0].map(((t,e)=>this.shape.map((t=>t[e])).reverse()))}setPosition(t){this.position=t}moveLeft(){this.position.x-=1}moveRight(){this.position.x+=1}moveDown(){this.position.y+=1}}}},e={};(function i(s){var o=e[s];if(void 0!==o)return o.exports;var h=e[s]={exports:{}};return t[s].call(h.exports,h,h.exports,i),h.exports})(154).Factory.createGame().runGame()})();